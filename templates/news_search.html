<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ğŸ“° ë‰´ìŠ¤ê²€ìƒ‰ê¸°</title>
    <style>body{font-family:'Malgun Gothic',sans-serif;}</style>
    <script>
      function selectAll(val){
        document.querySelectorAll('input[name="selected_urls"]').forEach(cb=>cb.checked=val);
        document.getElementById('form').submit(); // ì‹¤ì‹œê°„ ë°˜ì˜ (or ajax)
      }
      function copyText(){
        let ta=document.getElementById("copy_area");
        ta.select();document.execCommand("copy");alert("ë³µì‚¬ì™„ë£Œ");
      }
    </script>
</head>
<body>
<h2>ğŸ“° ë‰´ìŠ¤ê²€ìƒ‰ê¸° (FastAPI+Playwright)</h2>
<form method="post" id="form">
  <input type="text" name="keywords" value="{{keywords}}" style="width:90%">
  <input type="checkbox" name="checked_two_keywords" {% if checked_two_keywords %}checked{% endif %}> 2ê°œ ì´ìƒ í‚¤ì›Œë“œ
  <input type="radio" name="search_mode" value="major" {% if search_mode == "major" %}checked{% endif %}>ì£¼ìš”ì–¸ë¡ ì‚¬ë§Œ
  <input type="radio" name="search_mode" value="all" {% if search_mode == "all" %}checked{% endif %}>ì „ì²´
  <button type="submit">ğŸ” ë‰´ìŠ¤ ê²€ìƒ‰</button>
</form>
{% if final_results %}
  <button type="button" onclick="selectAll(true)">âœ… ì „ì²´ì„ íƒ</button>
  <button type="button" onclick="selectAll(false)">âŒ ì „ì²´í•´ì œ</button>
  <button type="button" onclick="copyText()">ğŸ“‹ ì„ íƒë³µì‚¬</button>
  <form method="post" action="/shorten">
    {% for n in final_results %}
      <input type="checkbox" name="selected_urls" value="{{n.url}}" checked> [{{n.press}}] {{n.title}} ({{n.kw_count}})
      <br>
    {% endfor %}
    <textarea id="copy_area" rows="10" style="width:100%">{{copy_area}}</textarea>
    <button type="submit">ì£¼ì†Œë³€í™˜</button>
  </form>
{% endif %}
{% if failures %}
  <div style="color:red">
    {% for fail in failures %}
      {{fail}}<br>
    {% endfor %}
  </div>
{% endif %}
</body>
</html>
